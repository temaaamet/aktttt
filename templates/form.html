
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Генерация акта</title>
</head>
<body>
  <form id="actForm">
    <!-- элементы формы (упрощено) -->
    <input type="text" id="fio" placeholder="ФИО" />
    <input type="text" id="inn" placeholder="ИНН" />
    <input type="text" id="contract_number" placeholder="Номер договора" />
    <input type="number" id="act_number" placeholder="Номер акта" />
    <input type="text" id="day" placeholder="День" />
    <input type="text" id="month" placeholder="Месяц" />
    <input type="number" id="qty" placeholder="Количество" />
    <input type="number" id="rub" placeholder="Цена (руб)" />
    <input type="number" id="kop" placeholder="Цена (коп)" />
    <button type="submit">Сгенерировать</button>
  </form>

  <script>
    document.getElementById("actForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const fio = document.getElementById("fio").value;
      const inn = document.getElementById("inn").value;
      const contract_number = document.getElementById("contract_number").value;
      const act_number = document.getElementById("act_number").value;
      const day = document.getElementById("day").value;
      const month = document.getElementById("month").value;
      const qty = parseInt(document.getElementById("qty").value);
      const rub = parseInt(document.getElementById("rub").value);
      const kop = parseInt(document.getElementById("kop").value);
      const total = qty * (rub + kop / 100);
      const sum_words = "TEMP"; // Здесь нужно заменить на функцию генерации прописью

      const response = await fetch("/generate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          day, month,
          act_number,
          contractor_name: fio,
          contractor_inn: inn,
          contract_number,
          qty, rub, kop,
          sum_total: total.toFixed(2),
          sum_total_words: sum_words
        })
      });

      const blob = await response.blob();
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "акт.docx";
      a.click();
      window.URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
